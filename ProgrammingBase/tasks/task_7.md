# Самостоятельная работа 7 - Personal Finance Manager PRO (дедлайн 20.12.25 включительно, до 20 баллов)

### Цель работы
Разработать консольное приложение для учета личных финансов. Программа должна позволять не только записывать расходы, но и редактировать их, фильтровать выдачу, управлять лимитами бюджета и прогнозировать траты.

**Срок выполнения:** 2 недели.
**Ограничения:** Использование сторонних библиотек (`pip install ...`) **ЗАПРЕЩЕНО**. Можно использовать только встроенные модули Python (`json`, `datetime`, `sys`, `argparse`, `math` и т.д.).

---

### Функциональные требования

#### 1. Управление данными (CRUD)
Программа должна поддерживать полный цикл работы с записями. Данные хранятся в файле `finance.json`.
*   **Добавление (`add`):** Аргументы: сумма, категория, дата (в формате YYYY-MM-DD), описание. Если дата не указана, используется текущая ("сегодня").
*   **Редактирование (`edit`):** Возможность изменить любое поле записи по её уникальному `id`.
*   **Удаление (`delete`):** Удаление записи по `id`.

#### 2. Просмотр и фильтрация (`list`)
Простой вывод всего списка неэффективен. Команда `list` должна поддерживать фильтры (аргументы опциональны):
*   `--category`: вывод записей только конкретной категории.
*   `--date`: вывод записей за конкретную дату.
*   `--sort`: сортировка вывода (по дате или по сумме).

#### 3. Система бюджетирования (`budget`)
Пользователь может установить лимит трат на категорию.
*   Команда `set-budget --category "Food" --limit 10000`: сохраняет лимит в отдельную структуру (можно в тот же json или отдельный файл).
*   При выводе статистики программа должна проверять, не превышен ли лимит по категории, и выводить предупреждение, если превышен, или показывать остаток, если нет.

#### 4. Аналитика и отчетность (`stats`)
Вывод сводной информации за определенный период (по умолчанию — текущий месяц):
*   Общая сумма расходов.
*   Расходы по каждой категории в процентном соотношении (например: "Еда: 50%").
*   **Прогноз:** Если статистика запрашивается в середине месяца, программа должна примерно рассчитать, сколько денег будет потрачено к концу месяца при текущем темпе трат (простая экстраполяция).

---

### Технические требования к реализации

1.  **Архитектура:** Код должен быть разбит на логические модули (функции). Запрещено писать "простыню" кода. Пример разделения:
    *   `storage.py` (или функции `load_data`, `save_data`) — чтение/запись JSON.
    *   `logic.py` — фильтрация, подсчет сумм, сортировка.
    *   `main.py` — парсинг аргументов и вывод в консоль.
2.  **Валидация:**
    *   Проверка корректности формата даты (валидация строки вида `2023-10-25`).
    *   Защита от ввода отрицательных сумм.
    *   Проверка существования ID при редактировании/удалении.
3.  **Обработка ошибок:** Программа не должна "падать" с Python Traceback. Все ошибки (неверный файл, неверный аргумент) должны перехватываться (`try-except`) и выводиться пользователю в понятном виде.

---

### Критерии оценки (Максимум 20 баллов)

Оценка формируется суммированием баллов за выполненные пункты.

#### Блок 1: Базовая логика и хранение (4 балла)
*   **(1 балл)** Реализована загрузка и сохранение данных в JSON. Файл создается автоматически, если его нет.
*   **(1 балл)** Работает команда `add` с генерацией уникальных ID для каждой записи.
*   **(1 балл)** Работает команда `delete` (удаление по ID).
*   **(1 балл)** Работает команда `edit` (изменение полей существующей записи).

#### Блок 2: Работа с данными и алгоритмы (5 баллов)
*   **(1 балл)** Реализована работа с датами через модуль `datetime`. Программа понимает формат `YYYY-MM-DD`, умеет подставлять текущую дату.
*   **(2 балла)** Реализована команда `list` с фильтрацией (по категории ИЛИ по дате) и сортировкой. *Внимание: сортировка должна быть реализована средствами Python (lambda functions, key).*
*   **(2 балла)** Реализован расчет статистики (`stats`): суммы по категориям и проценты от общего бюджета.

#### Блок 3: Продвинутый функционал (3 балла)
*   **(1.5 балла)** Реализована система бюджетов: установка лимита и отображение статуса (превышен/ок) при выводе статистики.
*   **(1.5 балла)** Реализован алгоритм прогноза трат на конец месяца (экстраполяция) или любая другая нетривиальная аналитика (например, "День с максимальной тратой").

#### Блок 4: Качество кода и интерфейс (3 балла)
*   **(1 балл)** Использование `argparse` для профессиональной обработки аргументов командной строки (вместо ручного разбора `sys.argv` через кучу `if`).
*   **(1 балл)** Чистота кода: функции не длиннее 20-30 строк, понятные названия переменных, отсутствие дублирования кода, наличие комментариев (Docstrings).
*   **(1 балл)** Надежность: корректная обработка исключений (неверный формат даты, ввод текста вместо числа, открытие битого JSON-файла).

#### Блок 5. Субъективная оценка преподавателя — 5 баллов

Сюда входит:

* Общее впечатление от работы
* Ясность, аккуратность и читаемость кода
* Качество логики боя и игровой динамики
* Креативность (доп. стратегии, эффекты, UI)
* Выполнение сверх минимума

---

# **Итого**

**Максимум: 20 баллов**

* **15 баллов** — объективные технические критерии
* **5 баллов** — субъективная оценка преподавателя

---

### Подсказки

1.  **Даты:** Используйте `datetime.strptime(date_string, "%Y-%m-%d")` для превращения строки в объект даты и `strftime` для обратного преобразования. Это позволит вам корректно сортировать и сравнивать даты.
2.  **Аргументы:** Изучите модуль `argparse`. Он позволяет создавать подкоманды (`subparsers`), например: `python budget.py add ...` и `python budget.py stats ...`.
3.  **Сортировка:** В Python у функции `sort` или `sorted` есть параметр `key`. Например, чтобы отсортировать список словарей по сумме: `sorted(records, key=lambda x: x['amount'])`.
4.  **Уникальные ID:** При добавлении записи можно искать максимальный существующий ID и прибавлять к нему 1, либо генерировать UUID (модуль `uuid`), либо использовать timestamp.


❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗

# ⚠ Штрафы

Работу нужно будет защитить с объяснением всего кода. Вы должны доказать, что код написан вами и вы в нем разбираетесь. Если данное условие не выполнено, баллы за задание **не выставляются**.
**Комментарии в коде запрещены.**

❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗❗